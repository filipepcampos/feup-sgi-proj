<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">tp1/parser/PrimitiveParser.js | sgi</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="## Group T04G05 | Name                          | Number    | E-Mail                   | | ----------------------------- | --------- | ------------------------ | | Filipe Pinto Campos           | 201905609 | up201905609@edu.fe.up.pt | | Francisco Gon&#xE7;alves Cerqueira | 201905337 | up201905337@edu.fe.up.pt |"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="sgi"><meta property="twitter:description" content="## Group T04G05 | Name                          | Number    | E-Mail                   | | ----------------------------- | --------- | ------------------------ | | Filipe Pinto Campos           | 201905609 | up201905609@edu.fe.up.pt | | Francisco Gon&#xE7;alves Cerqueira | 201905337 | up201905337@edu.fe.up.pt |"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a href="https://git.fe.up.pt/sgi-meic/sgi-2022-2023/t04/sgi-t04-g05.git">Repository</a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/MyInterface.js~MyInterface.html">MyInterface</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/MySceneGraph.js~MySceneGraph.html">MySceneGraph</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/XMLscene.js~XMLscene.html">XMLscene</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#models">models</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/models/Color.js~Color.html">Color</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/models/Coordinate3D.js~Coordinate3D.html">Coordinate3D</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/models/Rotation.js~Rotation.html">Rotation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/models/SceneData.js~SceneData.html">SceneData</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#models-graph">models/graph</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/models/graph/ComponentNode.js~ComponentNode.html">ComponentNode</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/models/graph/PrimitiveNode.js~PrimitiveNode.html">PrimitiveNode</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#models-wrappers">models/wrappers</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/models/wrappers/MyLight.js~MyLight.html">MyLight</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/models/wrappers/MyMaterial.js~MyMaterial.html">MyMaterial</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/models/wrappers/MySpotLight.js~MySpotLights.html">MySpotLights</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/models/wrappers/MyTexture.js~MyTexture.html">MyTexture</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/models/wrappers/MyTransformation.js~MyTransformation.html">MyTransformation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/models/wrappers/MyView.js~MyView.html">MyView</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#parser">parser</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/AmbientParser.js~AmbientParser.html">AmbientParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/BlockParser.js~BlockParser.html">BlockParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/ColorParser.js~ColorParser.html">ColorParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/Coordinate3DParser.js~Coordinate3DParser.html">Coordinate3DParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/FloatParser.js~FloatParser.html">FloatParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/GenericChildParser.js~GenericChildParser.html">GenericChildParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/IntegerParser.js~IntegerParser.html">IntegerParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/LightsParser.js~LightsParser.html">LightsParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/MaterialParser.js~MaterialParser.html">MaterialParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/ParserErrorPrinter.js~ParserErrorPrinter.html">ParserErrorPrinter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/ParserResult.js~ParserResult.html">ParserResult</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/PrimitiveParser.js~PrimitiveParser.html">PrimitiveParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/RotationParser.js~RotationParser.html">RotationParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/TextureParser.js~TextureParser.html">TextureParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/TransformationParser.js~TransformationParser.html">TransformationParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/ViewParser.js~ViewParser.html">ViewParser</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#parser-component">parser/component</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/component/ComponentChildrenParser.js~ComponentChildrenParser.html">ComponentChildrenParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/component/ComponentParser.js~ComponentParser.html">ComponentParser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/parser/component/ComponentsLinker.js~ComponentsLinker.html">ComponentsLinker</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#primitives">primitives</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/primitives/MyCylinder.js~MyCylinder.html">MyCylinder</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/primitives/MyRectangle.js~MyRectangle.html">MyRectangle</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/primitives/MySphere.js~MySphere.html">MySphere</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/primitives/MyTorus.js~MyTorus.html">MyTorus</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/primitives/MyTriangle.js~MyTriangle.html">MyTriangle</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#rendering">rendering</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/rendering/MaterialUpdater.js~MaterialUpdater.html">MaterialUpdater</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/tp1/rendering/SceneRenderer.js~SceneRenderer.html">SceneRenderer</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">tp1/parser/PrimitiveParser.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import { ParserResult } from &quot;./ParserResult.js&quot;;
import { FloatParser } from &quot;./FloatParser.js&quot;;
import { IntegerParser } from &quot;./IntegerParser.js&quot;;
import { MyRectangle } from &quot;../primitives/MyRectangle.js&quot;;
import { MyTriangle } from &quot;../primitives/MyTriangle.js&quot;;
import { MyCylinder } from &quot;../primitives/MyCylinder.js&quot;;
import { MySphere } from &quot;../primitives/MySphere.js&quot;;
import { MyTorus } from &quot;../primitives/MyTorus.js&quot;;
import {PrimitiveNode} from &quot;../models/graph/PrimitiveNode.js&quot;;

export class PrimitiveParser {
    static parse(node, reader, scene) {
        if (node.nodeName !== &quot;primitive&quot;) {
            return ParserResult.fromError(&quot;unknown tag &lt;&quot; + node.nodeName + &quot;&gt;&quot;);
        }

        let id = reader.getString(node, &quot;id&quot;);
        if (id == null) {
            return ParserResult.fromError(&quot;no id defined for primitive&quot;);
        }

        if (node.children.length === 1) {
            let childNode = node.children[0];
            let primitiveType = childNode.nodeName;

            if (primitiveType === &apos;rectangle&apos;) {
                return PrimitiveParser.parseRectangle(childNode, reader, scene, id);
            } else if (primitiveType === &apos;triangle&apos;) {
                return PrimitiveParser.parseTriangle(childNode, reader, scene, id);
            } else if (primitiveType === &apos;cylinder&apos;) {
                return PrimitiveParser.parseCylinder(childNode, reader, scene, id);
            } else if (primitiveType === &apos;sphere&apos;) {
                return PrimitiveParser.parseSphere(childNode, reader, scene, id);
            } else if (primitiveType === &apos;torus&apos;) {
                return PrimitiveParser.parseTorus(childNode, reader, scene, id);
            }
        }
        return ParserResult.fromError(&quot;There must be exactly 1 primitive type (rectangle, triangle, cylinder, sphere or torus)&quot;);
    }
    
    static parseRectangle(node, reader, scene, id) {
        let x1 = FloatParser.parse(node, reader, &apos;x1&apos;);
        let y1 = FloatParser.parse(node, reader, &apos;y1&apos;);
        let x2 = FloatParser.parse(node, reader, &apos;x2&apos;, x1.getValueOrDefault(0));
        let y2 = FloatParser.parse(node, reader, &apos;y2&apos;, y1.getValueOrDefault(0));

        let rectangle = new MyRectangle(
            scene, 
            x1.getValueOrDefault(0), 
            x2.getValueOrDefault(1), 
            y1.getValueOrDefault(0), 
            y2.getValueOrDefault(1)
        );
        return ParserResult.collect(
            new PrimitiveNode(id, rectangle),
            [x1, y1, x2, y2],
            &quot;parsing &lt;rectangle&gt; with id=&quot; + id
        );
    }

    static parseTriangle(node, reader, scene, id) {
        let x1 = FloatParser.parse(node, reader, &apos;x1&apos;);
        let y1 = FloatParser.parse(node, reader, &apos;y1&apos;);
        let z1 = FloatParser.parse(node, reader, &apos;z1&apos;);

        let x2 = FloatParser.parse(node, reader, &apos;x2&apos;);
        let y2 = FloatParser.parse(node, reader, &apos;y2&apos;);
        let z2 = FloatParser.parse(node, reader, &apos;z2&apos;);

        let x3 = FloatParser.parse(node, reader, &apos;x3&apos;);
        let y3 = FloatParser.parse(node, reader, &apos;y3&apos;);
        let z3 = FloatParser.parse(node, reader, &apos;z3&apos;);

        let triangle = new MyTriangle(
            scene, 
            x1.getValueOrDefault(0), 
            x2.getValueOrDefault(1),
            x3.getValueOrDefault(0),
            y1.getValueOrDefault(0),
            y2.getValueOrDefault(0),
            y3.getValueOrDefault(1),
            z1.getValueOrDefault(0),
            z2.getValueOrDefault(0),
            z3.getValueOrDefault(0)
        );

        return ParserResult.fromValue(
            new PrimitiveNode(id, triangle),
            [x1,y1,z1,x2,y2,z2,x3,y3,z3],
            &quot;parsing &lt;triangle&gt; with id=&quot; + id);
    }

    static parseCylinder(node, reader, scene, id) {
        let baseRadius = FloatParser.parse(node, reader, &apos;base&apos;, 0);
        let topRadius = FloatParser.parse(node, reader, &apos;top&apos;, 0);
        let height = FloatParser.parse(node, reader, &apos;height&apos;, 0);
        let slices = IntegerParser.parse(node, reader, &apos;slices&apos;, 1);
        let stacks = IntegerParser.parse(node, reader, &apos;stacks&apos;, 1);

        let collection = ParserResult.collect(null, [baseRadius, topRadius, height, slices, stacks]);
        if (collection.hasError()) {
            return collection;
        }

        let cylinder = new MyCylinder(
            scene, 
            baseRadius.getValueOrDefault(1),
            topRadius.getValueOrDefault(1),
            height.getValueOrDefault(1),
            slices.getValueOrDefault(8),
            stacks.getValueOrDefault(8)
        );
        
        return ParserResult.collect(
            new PrimitiveNode(id, cylinder),
            [baseRadius, topRadius, height, slices, stacks],
            &quot;parsing &lt;cylinder&gt; with id=&quot; + id
        );
    }

    static parseSphere(node, reader, scene, id) {
        let radius = FloatParser.parse(node, reader, &apos;radius&apos;, 0);
        let slices = IntegerParser.parse(node, reader, &apos;slices&apos;, 1);
        let stacks = IntegerParser.parse(node, reader, &apos;stacks&apos;, 1);

        let sphere = new MySphere(
            scene, 
            radius.getValueOrDefault(1),
            slices.getValueOrDefault(8),
            stacks.getValueOrDefault(8)
        );

        return ParserResult.collect(
            new PrimitiveNode(id, sphere),
            [radius, slices, stacks],
            &quot;parsing &lt;sphere&gt; with id=&quot; + id
        );
    }

    static parseTorus(node, reader, scene, id) {
        let inner = FloatParser.parse(node, reader, &apos;inner&apos;, 0);
        let outer = FloatParser.parse(node, reader, &apos;outer&apos;, 0);
        let slices = IntegerParser.parse(node, reader, &apos;slices&apos;, 1);
        let loops = IntegerParser.parse(node, reader, &apos;loops&apos;, 1);

        let torus = new MyTorus(
            scene, 
            inner.getValueOrDefault(1),
            outer.getValueOrDefault(1),
            slices.getValueOrDefault(8),
            loops.getValueOrDefault(8)
        );

        return ParserResult.collect(
            new PrimitiveNode(id, torus),
            [inner, outer, slices, loops],
            &quot;parsing &lt;torus&gt; with id=&quot; + id
        );
    }
}</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
